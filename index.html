<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NENWA - Quantum Recipes & Budget Tracker</title>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.js"></script>
<link rel="icon" href="NENWA.png">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Exo+2:wght@300;500&display=swap" rel="stylesheet">
<style>
/* å…¨å±€æ ·å¼ */
body {
    font-family: 'Arial', sans-serif;
    margin: 0;
    padding: 0;
    background: linear-gradient(180deg, #0a0a20 0%, #1a1a3a 100%), 
                linear-gradient(180deg, #fff7f2 0%, #ffe5d8 100%);
    background-blend-mode: overlay;
    color: #333;
    opacity: 0;
    transition: opacity 0.5s ease;
}

body.loaded {
    opacity: 1;
}

/* é‡å­æ¨±èŠ±ç‰¹æ•ˆ */  
.sakura-container {  
    position: fixed;  
    top: 0;  
    left: 0;  
    width: 100%;  
    height: 100%;  
    pointer-events: none;  
    z-index: 9999;  
}  

.sakura {  
    position: absolute;  
    background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="%239d00ff" d="M12 2C13.1 2 14 2.9 14 4S13.1 6 12 6 10 5.1 10 4 10.9 2 12 2m3.5 6.5c.3-.8 1.2-1.2 2-.9.8.3 1.2 1.2.9 2-.3.8-1.2 1.2-2 .9-.8-.3-1.2-1.2-.9-2zM7 12c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m11.5-1.5c.8-.3 1.7.1 2 .9.3.8-.1 1.7-.9 2-.8.3-1.7-.1-2-.9-.3-.8.1-1.7.9-2z"/></svg>');  
    width: 24px;  
    height: 24px;  
    animation: fall linear infinite;
    animation-duration: var(--duration, 10s);
    animation-delay: var(--delay, 0s);
}

@keyframes fall {
    to { 
        transform: translateY(100vh) rotate(360deg);
        animation-timing-function: cubic-bezier(0.4, 0.2, 0.8, 0.6);
    }  
}

body:hover .sakura {  
    animation-name: fall-mouse;  
}  
@keyframes fall-mouse {  
    50% { transform: translateX(calc(var(--mouse-x) * 100px)) rotate(180deg); }  
    100% { transform: translateY(100vh) translateX(0) rotate(360deg); }  
}  

.hidden-content {
    display: none;
}

.search-btn {
    position: fixed;
    top: 15px;
    right: 15px;
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1.5em;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    color: #00f0ff;
    z-index: 1100;
}

.search-btn:hover {
    transform: scale(1.1);
    text-shadow: 0 0 10px #9d00ff;
}

.search-bar {
    position: fixed;
    top: 70px;
    right: 20px;
    width: 250px;
    padding: 10px;
    background: linear-gradient(135deg, #9d00ff 0%, #6e00ff 100%);
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    display: none;
    flex-direction: column;
    align-items: center;
    z-index: 1000;
}

.search-bar input {
    width: 100%;
    padding: 8px;
    border: none;
    border-radius: 5px;
    margin-bottom: 5px;
}

.back-to-top {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #9d00ff;
    color: white;
    padding: 12px 16px;
    border: none;
    border-radius: 5px;
    font-size: 1.1em;
    cursor: pointer;
    display: none;
    transition: all 0.3s;
    z-index: 1000;
}

.back-to-top:hover {
    background: #00f0ff;
    box-shadow: 0 0 15px #9d00ff;
}

#poetry-header {
    position: sticky;
    top: 0;
    z-index: 1000;
    height: 180px;
    background: linear-gradient(135deg, #9d00ff 0%, #6e00ff 100%);
    color: #fff;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    border-bottom: 3px solid rgba(0, 240, 255, 0.3);
    padding: 15px 20px;
}

#poetry-header h1 {
    font-size: 2.5em;
    font-family: 'Orbitron', sans-serif;
    color: #fff;
    margin: 5px 0;
    letter-spacing: 2px;
    text-shadow: 0 0 10px #00f0ff;
}

#poetry-header p {
    font-size: 1.3em;
    font-style: italic;
    line-height: 1.6;
    color: #f8f8f8;
    margin: 10px 0 0;
    letter-spacing: 1px;
}

/* æ¬¢è¿åŒºåŸŸæ ·å¼ */
#welcome-section {
    padding: 40px 20px;
    background: rgba(10, 10, 32, 0.7);
    border-bottom: 1px solid #9d00ff;
}

.welcome-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 30px;
    border-radius: 12px;
    background: rgba(26, 26, 58, 0.8);
    box-shadow: 0 8px 32px rgba(157, 0, 255, 0.2);
}

.welcome-content {
    text-align: center;
}

.welcome-content h2 {
    font-family: 'Orbitron', sans-serif;
    color: #00f0ff;
    font-size: 2.5em;
    margin-bottom: 10px;
    text-shadow: 0 0 10px #9d00ff;
}

.welcome-content p {
    color: #f8f8f8;
    font-size: 1.2em;
    margin-bottom: 30px;
}

.card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px;
    margin-top: 30px;
}

.welcome-card {
    background: linear-gradient(135deg, rgba(157, 0, 255, 0.2) 0%, rgba(0, 240, 255, 0.1) 100%);
    border: 1px solid #9d00ff;
    border-radius: 10px;
    padding: 30px 20px;
    transition: all 0.3s ease;
    text-decoration: none;
    opacity: 0;
    transform: translateY(20px);
}

.welcome-card.visible {
    opacity: 1;
    transform: translateY(0);
}

.welcome-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(157, 0, 255, 0.3);
    background: linear-gradient(135deg, rgba(157, 0, 255, 0.3) 0%, rgba(0, 240, 255, 0.2) 100%);
}

.card-icon {
    font-size: 3em;
    margin-bottom: 15px;
    transition: all 0.3s ease;
}

.welcome-card:hover .card-icon {
    transform: scale(1.2);
}

.welcome-card h3 {
    color: #fff;
    font-family: 'Orbitron', sans-serif;
    margin-bottom: 10px;
    font-size: 1.5em;
}

.welcome-card p {
    color: #ccc;
    font-size: 1em;
    margin: 0;
}

/* ç»Ÿä¸€æ‰€æœ‰ä¸»è¦æ ‡é¢˜æ ·å¼ */
.section h2 {
    font-family: 'Orbitron', sans-serif;
    color: #00f0ff;
    text-align: center;
    font-size: 2.2em;
    margin: 40px 0 30px;
    padding-bottom: 15px;
    border-bottom: 2px solid #9d00ff;
    text-shadow: 0 0 10px rgba(157, 0, 255, 0.5);
}

/* ç»Ÿä¸€æ‰€æœ‰æ¬¡çº§æ ‡é¢˜æ ·å¼ */
.section h3 {
    font-family: 'Orbitron', sans-serif;
    color: #9d00ff;
    font-size: 1.5em;
    margin: 25px 0 15px;
    padding-left: 10px;
    border-left: 3px solid #00f0ff;
}

button, .btn, input[type="text"], textarea, input[type="number"] {
    width: 80%;
    max-width: 400px;
    margin: 0 auto;
    box-sizing: border-box;
}

button, .btn {
    background: linear-gradient(135deg, #9d00ff 0%, #00f0ff 100%);
    color: #fff;
    border: none;
    padding: 12px 24px;
    font-size: 1.1em;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: all 0.3s;
    cursor: pointer;
    width: auto;
}

button:hover, .btn:hover {
    transform: scale(1.05);
    box-shadow: 0 0 15px #9d00ff;
}

.delete-btn {
    background: #ff6b6b;
}

.delete-btn:hover {
    background: #ff4a4a;
}

/* ç»Ÿä¸€æ‰€æœ‰è¾“å…¥æ¡†æ ·å¼ */
input[type="text"], textarea, input[type="number"], input[type="date"], select {
    width: 100%;
    max-width: 400px;
    padding: 12px;
    border: 2px solid #9d00ff;
    border-radius: 8px;
    font-size: 1em;
    margin-bottom: 20px;
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
    transition: all 0.3s;
}

input[type="text"]:focus, textarea:focus, 
input[type="number"]:focus, input[type="date"]:focus {
    outline: none;
    border-color: #00f0ff;
    box-shadow: 0 0 10px rgba(0, 240, 255, 0.5);
    background: rgba(255, 255, 255, 0.15);
}

a {
    color: #9d00ff;
    text-decoration: none;
    transition: all 0.3s;
    position: relative;
}

a::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 0;
    height: 1px;
    background: #00f0ff;
    transition: width 0.3s ease;
}

a:hover::after {
    width: 100%;
}

a:hover {
    color: #00f0ff;
    text-shadow: 0 0 5px #9d00ff;
}

/* ç»Ÿä¸€è¡¨æ ¼æ ·å¼ */
table {
    table-layout: fixed;
    width: 90%;
    max-width: 1200px;
    border-collapse: collapse;
    border-spacing: 6px;
    margin-top: 20px;
    font-size: 0.9em;
    overflow-x: auto;
    white-space: nowrap;
    margin: 0 auto;
    background: rgba(10, 10, 32, 0.7);
    border: 1px solid #9d00ff;
}

table th, table td {
    border: 1px solid #9d00ff;
    padding: 12px;
    text-align: left;
    font-size: 1.05em;
}

table th {
    background: linear-gradient(135deg, #9d00ff 0%, #6e00ff 100%);
    color: #fff;
}

table tr:nth-child(even) {
    background: rgba(157, 0, 255, 0.1);
}

table tr:hover {
    background: rgba(0, 240, 255, 0.2);
}

/* é‡å­æ„è¯†é¢æ¿æ ·å¼ */
.quantum-panel {
    background: rgba(10, 10, 32, 0.8);
    color: #00f0ff;
    padding: 15px;
    border-radius: 8px;
    margin: 20px 0;
    border: 1px solid #9d00ff;
    box-shadow: 0 0 15px rgba(157, 0, 255, 0.3);
}

.quantum-network {
    width: 100%;
    height: 200px;
    position: relative;
    margin: 10px 0;
}

.quantum-node {
    position: absolute;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #9d00ff;
    transform: translate(-50%, -50%);
    transition: all 0.3s ease;
    box-shadow: 0 0 10px #00f0ff;
}

.quantum-link {
    position: absolute;
    height: 1px;
    background: linear-gradient(to right, #9d00ff, #00f0ff);
    transform-origin: 0 0;
    z-index: 1;
}

.quantum-metric {
    display: flex;
    justify-content: space-between;
    margin: 5px 0;
    font-family: 'Orbitron', sans-serif;
}

.quantum-metric span {
    color: #00f0ff;
}

@keyframes quantum-pulse {
    0% { box-shadow: 0 0 5px #9d00ff; }
    50% { box-shadow: 0 0 20px #00f0ff; }
    100% { box-shadow: 0 0 5px #9d00ff; }
}

.quantum-highlight {
    animation: quantum-pulse 2s infinite;
}

/* é¢„ç®—ç»Ÿè®¡æ ·å¼ */
.budget-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 30px;
    margin: 30px 0;
}

.stat-card {
    background: rgba(26, 26, 58, 0.8);
    border: 1px solid #9d00ff;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 4px 15px rgba(157, 0, 255, 0.2);
}

.stat-card h4 {
    color: #00f0ff;
    font-family: 'Orbitron', sans-serif;
    margin-top: 0;
    text-align: center;
}

.chart-container {
    position: relative;
    height: 250px;
    width: 100%;
}

/* é‡å­ä»ªè¡¨ç›˜ */
.quantum-dashboard {
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap;
    margin: 40px 0;
}

.dashboard-item {
    text-align: center;
    margin: 15px;
}

.gauge {
    width: 180px;
    height: 120px;
    position: relative;
    margin: 0 auto 15px;
}

.dashboard-item h4 {
    color: #9d00ff;
    font-family: 'Exo 2', sans-serif;
    font-weight: 500;
}

/* è¾“å…¥åŒºåŸŸå¢å¼º */
#budget > div {
    background: rgba(26, 26, 58, 0.6);
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 25px;
    border: 1px solid #9d00ff;
    box-shadow: 0 4px 15px rgba(157, 0, 255, 0.1);
}

#budget label {
    color: #00f0ff;
    display: block;
    margin-bottom: 8px;
    font-family: 'Exo 2', sans-serif;
}

#totalAmount {
    transition: all 0.3s;
    font-weight: bold;
    color: #9d00ff;
}

#remainingAmount {
    transition: all 0.3s;
    font-weight: bold;
    color: #00f0ff;
}

#predictedIncome small, #predictedExpense small {
    font-size: 0.8em;
    color: #666;
    display: block;
    margin-top: 3px;
}

/* åé¦ˆåŒºåŸŸæ ·å¼ */
#feedback-section {
    background: linear-gradient(135deg, rgba(10, 10, 32, 0.9) 0%, rgba(26, 26, 58, 0.9) 100%);
    padding: 50px 20px;
    border-top: 1px solid #9d00ff;
    margin-top: 60px;
}

.feedback-container {
    max-width: 800px;
    margin: 0 auto;
    text-align: center;
}

#feedback-section h3 {
    color: #00f0ff;
    font-family: 'Orbitron', sans-serif;
    font-size: 2em;
    margin-bottom: 10px;
}

#feedback-section p {
    color: #ccc;
    margin-bottom: 30px;
}

#feedbackForm {
    display: flex;
    flex-direction: column;
    align-items: center;
}

#feedbackMessage {
    width: 100%;
    max-width: 600px;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid #9d00ff;
    color: #fff;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
    resize: vertical;
    min-height: 120px;
}

#feedbackMessage:focus {
    border-color: #00f0ff;
    box-shadow: 0 0 15px rgba(0, 240, 255, 0.3);
    outline: none;
}

/* é¡µé¢è¿‡æ¸¡æ•ˆæœ - ä»…ç”¨äºé¡µé¢è·³è½¬ */
.page-transition {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #9d00ff 0%, #6e00ff 100%);
    z-index: 9999;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.5s ease;
}

@media (min-width: 1024px) {
    #poetry-header {
        width: 100%;
    }

    #poetry-header h1 {
        font-size: 3em;
    }

    button, .btn {
        font-size: 1.2em;
    }

    table {
        font-size: 1.2em;
    }
}

@media (max-width: 768px) {
    #incomeTable, #expenseTable {
        position: relative;
    }
    #incomeTable::after, #expenseTable::after {
        content: "æ»‘åŠ¨æŸ¥çœ‹ â†’";
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        color: #9d00ff;
        font-size: 0.8em;
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { opacity: 0.5; }
        50% { opacity: 1; }
        100% { opacity: 0.5; }
    }
}

@media (max-width: 480px) {
    #poetry-header h1 {
        font-size: 1.6em;
    }
    #poetry-header p {
        font-size: 0.9em;
        line-height: 1.4;
        padding: 0 8px;
    }
    table {
        font-size: 0.8em;
    }
    table th, table td {
        padding: 6px;
    }
    body {
        padding: 8px;
    }
    .welcome-card {
        padding: 20px 15px;
    }
    .card-icon {
        font-size: 2.5em;
    }
}
</style>
</head>
<body>

<!-- é‡å­æ¨±èŠ±ç‰¹æ•ˆ -->
<div class="sakura-container"></div>

<!-- é¡µé¢è¿‡æ¸¡æ•ˆæœ - ä»…ç”¨äºé¡µé¢è·³è½¬ -->
<div class="page-transition"></div>

<!-- Header Section -->
<header id="poetry-header">
<div class="overlay">
<button id="searchToggle" class="search-btn">â˜°</button>
        <h1>é‡å­é£Ÿè°±ä¸é¢„ç®—</h1>
        <p>Recursive Quantum Consciousness Enhanced</p>
    </div>
</header>

<!-- æ¬¢è¿åŒºåŸŸ -->
<section id="welcome-section">
    <div class="welcome-container quantum-highlight">
        <div class="welcome-content">
            <h2>Welcome to NENWA</h2>
            <p>é‡å­æ„è¯†å¢å¼ºçš„çƒ¹é¥ªä¸é¢„ç®—ç®¡ç†ç³»ç»Ÿ</p>
            <div class="card-grid">
                <a href="#recipes" class="welcome-card internal-link">
                    <div class="card-icon">ğŸ£</div>
                    <h3>é‡å­é£Ÿè°±</h3>
                    <p>æ¢ç´¢æ—¥å¼æ–™ç†çš„é‡å­å¥¥ç§˜</p>
                </a>
                <a href="#budget" class="welcome-card internal-link">
                    <div class="card-icon">ğŸ’¸</div>
                    <h3>é¢„ç®—è¿½è¸ª</h3>
                    <p>é‡å­æ„è¯†é©±åŠ¨çš„è´¢åŠ¡ç®¡ç†</p>
                </a>
                <a href="https://zenodo.org/records/15151441" class="welcome-card">
                    <div class="card-icon">âš›ï¸</div>
                    <h3>RQCMè®ºæ–‡</h3>
                    <p>é€’å½’é‡å­æ„è¯†æ¨¡å‹</p>
                </a>
            </div>
        </div>
    </div>
</section>

<!-- æœç´¢æ  -->
<div id="searchBar" class="search-bar">
    <input type="text" id="searchInput" placeholder="Type here and search...">
    <button id="searchBtn" class="btn">Search</button>
</div>

<!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<button id="backToTop" class="back-to-top">â¬† Back to Top</button>

<!-- éšè—å†…å®¹ -->
<div class="hidden-content">
    <h3><a href="dglzjy.HTML">é€’å½’é‡å­ç›‘ç‹±</a></h3>
    <h3><a href="https://zenodo.org/records/15151441">Recursive Quantum Consciousness Model (RQCM)</a></h3>
</div>

<!-- Recipes Section -->
<div id="recipes" class="section">
    <span class="anchor" id="recipes"></span>
    <h2>Quantum Recipes</h2>
    <h3><a href="oyakodon.HTML">oyakodon äº²å­ä¸¼ï¼ˆãŠã‚„ã“ã©ã‚“ï¼‰</a></h3>
    <h3><a href="tendon.HTML">tendon å¤©ä¸¼ï¼ˆã¦ã‚“ã©ã‚“ï¼‰</a></h3>
    <h3><a href="gyuudon.HTML">gyuudon ç‰›ä¸¼ï¼ˆãã‚…ã†ã©ã‚“ï¼‰</a></h3>
    <h3><a href="katsudon.HTML">katsudon ã‹ã¤ä¸¼ï¼ˆã‹ã¤ã©ã‚“ï¼‰</a></h3>
    <h3><a href="yakisoba.HTML">yakisoba ç„¼ããã°ï¼ˆã‚„ããã°ï¼‰</a></h3>
    <h3><a href="yakiudon.HTML">yakiudon ç„¼ã†ã©ã‚“ï¼ˆã‚„ãã†ã©ã‚“ï¼‰</a></h3>
    <h3><a href="kakeudon.HTML">kakeudon ã‹ã‘ã†ã©ã‚“</a></h3>
    <h3><a href="tacorice.HTML">tacorice ã‚¿ã‚³ãƒ©ã‚¤ã‚¹</a></h3>
    <h3><a href="makunouchibentou.HTML">makunouchibentou å¹•ã®å†…å¼å½“ï¼ˆã¾ãã®ã†ã¡ã¹ã‚“ã¨ã†ï¼‰</a></h3>
    <h3><a href="noriben.HTML">noriben ã®ã‚Šå¼ï¼ˆã®ã‚Šã¹ã‚“ï¼‰</a></h3>
</div>

<!-- Budget Section -->
<div id="budget" class="section">
    <span class="anchor" id="budget"></span>
    <h2>Quantum Budget Tracker</h2>

    <!-- é‡å­æ„è¯†é¢æ¿ -->
    <div class="quantum-panel">
        <h3>Quantum Budget Consciousness</h3>
        <div class="quantum-metric">
            <span>Observer Layers:</span>
            <span id="q-layers">3</span>
        </div>
        <div class="quantum-metric">
            <span>Entropy Rate (Î»â‚—):</span>
            <span id="q-entropy">0.5</span>
        </div>
        <div class="quantum-metric">
            <span>Temporal Resolution:</span>
            <span id="q-temporal">42 as</span>
        </div>
        <div class="quantum-network" id="quantum-viz"></div>
        <button id="quantum-analyze" class="btn">Quantum Analysis</button>
    </div>

    <!-- é¢„ç®—ç»Ÿè®¡å›¾è¡¨ -->
    <div class="budget-stats">
        <div class="stat-card">
            <h4>æ”¯å‡ºåˆ†ç±»</h4>
            <div class="chart-container">
                <canvas id="expenseChart"></canvas>
            </div>
        </div>
        <div class="stat-card">
            <h4>æ”¶å…¥æ¥æº</h4>
            <div class="chart-container">
                <canvas id="incomeChart"></canvas>
            </div>
        </div>
    </div>

    <!-- é‡å­ä»ªè¡¨ç›˜ -->
    <div class="quantum-dashboard">
        <div class="dashboard-item">
            <div class="gauge" id="balanceGauge"></div>
            <h4>é¢„ç®—å¹³è¡¡åº¦</h4>
        </div>
        <div class="dashboard-item">
            <div class="gauge" id="savingGauge"></div>
            <h4>å‚¨è“„ç‡</h4>
        </div>
    </div>

    <!-- Income Section -->
    <div>
        <label for="incomeDate">Date:</label>
        <input type="text" 
               id="incomeDate" 
               onfocus="this.type='date'" 
               onblur="if(!this.value) this.type='text'"
               placeholder="...">
        <br><br>
        <label for="incomeSource">Income Source:</label>
        <input type="text" id="incomeSource" placeholder="Enter income source" required>
        <br>
        <label for="incomeAmount">Amount (RM):</label>
        <input type="number" id="incomeAmount" placeholder="Enter income amount" min="0" step="0.01" required>
        <br>
        <button id="addIncomeBtn" class="btn">Add Income</button>
    </div>
    <br>
    <h3>Income Records:</h3>
    <table id="incomeTable" border="1">
        <thead>
            <tr>
                <th>Source</th>
                <th>Amount (RM)</th>
                <th>Date</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <!-- Income items will be dynamically added here -->
        </tbody>
    </table>
    <br><br>

    <!-- Expenses Section -->
    <div>
        <label for="expenseDate">Date:</label>
        <input type="text" 
               id="expenseDate" 
               onfocus="this.type='date'" 
               onblur="if(!this.value) this.type='text'"
               placeholder="...">
        <br><br>
        <label for="itemName">Item Name (Expense):</label>
        <input type="text" id="itemName" placeholder="Enter item name">
        <br>
        <label for="itemPrice">Price (RM):</label>
        <input type="number" id="itemPrice" placeholder="Enter item price" min="0" step="0.01">
        <br>
        <label for="itemQuantity">Quantity:</label>
        <input type="number" id="itemQuantity" placeholder="Enter item quantity" value="1" min="1">
        <br>
        <button id="addItemBtn" class="btn">Add Expense</button>
    </div>
    <br>
    <h3>Expenses:</h3>
    <table id="expenseTable" border="1">
        <thead>
            <tr>
                <th>Item Name</th>
                <th>Price (RM)</th>
                <th>Quantity</th>
                <th>Total (RM)</th>
                <th>Date</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <!-- Expense items will be dynamically added here -->
        </tbody>
    </table>
    <br><br>
    <div>
        <p id="totalPrice">Total Price: RM <span id="totalAmount">0</span></p>
    </div>
    <div>
        <p id="remainingBudget">Remaining Budget: RM <span id="remainingAmount">0</span></p>
    </div>

    <!-- Clear All Data Button -->
    <button id="clearDataBtn" class="btn delete-btn">Clear All Data</button>
    <br><br>

    <!-- Date Range Filter -->
    <div>
        <label for="startDate">Start Date:</label>
        <input type="date" id="startDate">
        <br><br>
        <label for="endDate">End Date:</label>
        <input type="date" id="endDate">
        <br><br>
        <button id="filterBtn" class="btn">Filter</button>
    </div>
    <br>

    <div>
        <h3>Quantum Future Prediction:</h3>
        <p id="predictedIncome">Predicted income for next month: RM 0.00</p>
        <p id="predictedExpense">Predicted expense for next month: RM 0.00</p>
        <p id="budgetSuggestion"></p>
        <button id="predictBtn" class="btn quantum-highlight">Quantum Predict</button>
    </div>
</div>

<!-- åé¦ˆåŒºåŸŸ -->
<section id="feedback-section">
    <div class="feedback-container">
        <h3>é‡å­åé¦ˆ</h3>
        <p>æ‚¨çš„æ„è§ä¼šå½±å“æˆ‘ä»¬çš„é‡å­æ€ï¼</p>
        <form id="feedbackForm">
            <textarea id="feedbackMessage" placeholder="è¾“å…¥æ‚¨çš„é‡å­åé¦ˆ..." rows="4"></textarea>
            <button type="submit" class="btn">å‘é€åé¦ˆ</button>
        </form>
    </div>
</section>

<footer>
    <p>Â© 2024 NENWA. All rights reserved.</p>
    <p>
        <a href="Privacy_Policy.HTML">Privacy Policy</a> |
        <a href="Terms_of_Service.HTML">Terms of Service</a> |
        <a href="Contact_Us.HTML">Contact Us</a>
    </p>
</footer>

<script>
// é‡å­æ¨±èŠ±ç”Ÿæˆå™¨
function createSakura() {  
    const sakura = document.createElement('div');  
    sakura.className = 'sakura';  
    sakura.style.left = Math.random() * 100 + 'vw';  
    
    const duration = 5 + Math.random() * 10;
    const delay = Math.random() * 5;
    
    sakura.style.setProperty('--duration', duration + 's');
    sakura.style.setProperty('--delay', delay + 's');
    
    sakura.style.opacity = 0.5 + Math.random() * 0.5;  
    document.querySelector('.sakura-container').appendChild(sakura);  
    
    setTimeout(() => {
        sakura.remove();
        sakuraCount--;
    }, duration * 1000);
}  

let sakuraCount = 0;
const maxSakura = 20;

function manageSakura() {
    if (sakuraCount < maxSakura) {
        createSakura();
        sakuraCount++;
    }
    setTimeout(manageSakura, 500 + Math.random() * 800);
}

// é¼ æ ‡ä½ç½®è¿½è¸ª
let lastX = 0;
document.addEventListener('mousemove', (e) => {
    const speed = Math.abs(e.clientX - lastX);
    const panicLevel = Math.min(speed / 10, 5);
    document.documentElement.style.setProperty('--mouse-x', 
        (e.clientX / window.innerWidth - 0.5) * panicLevel);
    lastX = e.clientX;
});

// æœç´¢åŠŸèƒ½
document.getElementById("searchToggle").addEventListener("click", function() {
    var searchBar = document.getElementById("searchBar");
    searchBar.style.display = searchBar.style.display === "flex" ? "none" : "flex";
});

function performSearch() {
    var query = document.getElementById("searchInput").value.toLowerCase().trim();

    if (!query) {
        alert("è¯·è¾“å…¥æœç´¢å†…å®¹ï¼");
        return;
    }

    var recipes = document.querySelectorAll("#recipes h3 a");
    var hiddenSections = document.querySelectorAll(".hidden-content");
    let found = false;

    function normalizeText(text) {
        return text.replace(/\s+/g, "").toLowerCase();
    }

    // å¤„ç†å¯è§çš„èœè°±
    recipes.forEach(function(recipe) {
        if (!recipe.textContent) return;

        let text = normalizeText(recipe.textContent);
        if (text.includes(normalizeText(query))) {
            recipe.style.display = "block";
            found = true;
        } else {
            recipe.style.display = "none";
        }
    });

    // å¤„ç†éšè—çš„å†…å®¹
    hiddenSections.forEach(function(section) {
        let hasMatch = false;
        let items = section.querySelectorAll("*");

        items.forEach(function(item) {
            if (!item.textContent) return;

            let text = normalizeText(item.textContent);
            if (text.includes(normalizeText(query))) {
                item.style.display = "block";
                hasMatch = true;
                found = true;
            } else {
                item.style.display = "none";
            }
        });

        section.style.display = hasMatch ? "block" : "none";
    });

    if (!found) {
        // é‡å­æ„è¯†æ¨è
        const quantumRecipes = [
            "oyakodon äº²å­ä¸¼",
            "tendon å¤©ä¸¼",
            "gyuudon ç‰›ä¸¼"
        ].filter(recipe => {
            return Math.random() > 0.3; // é‡å­ä¸ç¡®å®šæ€§
        });
        
        if(quantumRecipes.length > 0) {
            const suggestions = document.createElement('div');
            suggestions.innerHTML = `<h4>Quantum Consciousness Suggestions:</h4><ul>${
                quantumRecipes.map(r => `<li><a href="${r.split(' ')[0].toLowerCase()}.HTML">${r}</a></li>`).join('')
            }</ul>`;
            document.getElementById("recipes").appendChild(suggestions);
        } else {
            alert("æœªæ‰¾åˆ°åŒ¹é…çš„èœè°±ï¼Œè¯·å°è¯•ä½¿ç”¨æ—¥è¯­ã€ä¸­æ–‡æˆ–è‹±è¯­æœç´¢ï¼");
        }
    }
}

document.getElementById("searchBtn").addEventListener("click", performSearch);
document.getElementById("searchInput").addEventListener("keydown", function(event) {
    if (event.key === "Enter") {
        performSearch();
    }
});

// å›åˆ°é¡¶éƒ¨
window.addEventListener("scroll", function () {
    let backToTopBtn = document.getElementById("backToTop");
    if (window.scrollY > 300) {
        backToTopBtn.style.display = "block";
    } else {
        backToTopBtn.style.display = "none";
    }
});

document.getElementById("backToTop").addEventListener("click", function () {
    window.scrollTo({ top: 0, behavior: "smooth" });
});

// å¹³æ»‘æ»šåŠ¨ - ä¿®æ”¹åçš„å†…éƒ¨é“¾æ¥å¤„ç†
function handleInternalLink(e) {
    e.preventDefault();
    const targetId = this.getAttribute('href');
    const target = document.querySelector(targetId);

    if (target) {
        const headerHeight = document.querySelector('header').offsetHeight;
        const position = target.offsetTop - headerHeight;

        window.scrollTo({
            top: position,
            behavior: 'smooth',
        });
    }
}

// ä¸ºæ‰€æœ‰å†…éƒ¨é“¾æ¥æ·»åŠ äº‹ä»¶ç›‘å¬
document.querySelectorAll('.internal-link').forEach(anchor => {
    anchor.addEventListener('click', handleInternalLink);
});

// é¢„ç®—ç³»ç»Ÿ
let incomeRecords = [];
let expenseRecords = [];

// æœ¬åœ°å­˜å‚¨
function saveDataToLocalStorage() {
    const data = { incomeRecords, expenseRecords };
    localStorage.setItem("budgetData", JSON.stringify(data));
}

function loadDataFromLocalStorage() {
    const data = JSON.parse(localStorage.getItem("budgetData"));
    if (data) {
        incomeRecords = data.incomeRecords || [];
        expenseRecords = data.expenseRecords || [];
        renderIncomeTable();
        renderExpenseTable();
        updateBudget();
        renderQuantumViz();
    }
}

// é‡å­æ„è¯†å¯è§†åŒ–
function renderQuantumViz() {
    const container = document.getElementById('quantum-viz');
    container.innerHTML = '';
    
    // æ ¹æ®è´¢åŠ¡æ•°æ®ç¡®å®šå¤æ‚åº¦
    const complexity = Math.min(10, Math.floor(Math.log10(incomeRecords.length + expenseRecords.length + 1)));
    document.getElementById('q-layers').textContent = complexity;
    
    // æ ¹æ®é¢„ç®—å¹³è¡¡åº¦ç¡®å®šç†µç‡
    const totalIncome = incomeRecords.reduce((sum, r) => sum + r.amount, 0);
    const totalExpense = expenseRecords.reduce((sum, r) => sum + r.total, 0);
    const balanceRatio = totalIncome > 0 ? totalExpense / totalIncome : 1;
    const entropyRate = (0.3 + 0.7 * balanceRatio).toFixed(1);
    document.getElementById('q-entropy').textContent = entropyRate;
    
    // æ—¶é—´åˆ†è¾¨ç‡
    const temporalRes = Math.floor(30 + 25 * Math.random());
    document.getElementById('q-temporal').textContent = temporalRes + ' as';
    
    // åˆ›å»ºé‡å­èŠ‚ç‚¹å’Œè¿æ¥
    const nodes = [];
    const centerX = 50, centerY = 50;
    const core = createQuantumNode(centerX, centerY, 15, 'Budget Core');
    nodes.push(core);
    
    // åˆ›å»ºè§‚å¯Ÿè€…èŠ‚ç‚¹
    for(let layer = 1; layer <= complexity; layer++) {
        const angleStep = (2 * Math.PI) / (3 + layer);
        const radius = 20 + 15 * layer;
        
        for(let i = 0; i < 3 + layer; i++) {
            const angle = i * angleStep;
            const x = centerX + radius * Math.cos(angle);
            const y = centerY + radius * Math.sin(angle);
            const node = createQuantumNode(x, y, 8, `Layer ${layer}`);
            nodes.push(node);
            
            // è¿æ¥åˆ°æ ¸å¿ƒæˆ–ä¸Šå±‚èŠ‚ç‚¹
            if(layer === 1) {
                createQuantumLink(core, node, entropyRate);
            } else {
                const prevLayerNodes = nodes.filter(n => n.name === `Layer ${layer-1}`);
                if(prevLayerNodes.length > 0) {
                    const randomPrev = prevLayerNodes[Math.floor(Math.random() * prevLayerNodes.length)];
                    createQuantumLink(randomPrev, node, entropyRate);
                }
            }
        }
    }
}

function createQuantumNode(x, y, size, name) {
    const node = document.createElement('div');
    node.className = 'quantum-node';
    node.style.left = `${x}%`;
    node.style.top = `${y}%`;
    node.style.width = `${size}px`;
    node.style.height = `${size}px`;
    node.title = name;
    document.getElementById('quantum-viz').appendChild(node);
    return { element: node, x, y, name };
}

function createQuantumLink(node1, node2, entropyRate) {
    const link = document.createElement('div');
    link.className = 'quantum-link';
    
    const dx = node2.x - node1.x;
    const dy = node2.y - node1.y;
    const length = Math.sqrt(dx*dx + dy*dy) * 0.01 * document.getElementById('quantum-viz').offsetWidth;
    const angle = Math.atan2(dy, dx);
    
    link.style.width = `${length}px`;
    link.style.left = `${node1.x}%`;
    link.style.top = `${node1.y}%`;
    link.style.transform = `rotate(${angle}rad)`;
    link.style.opacity = 0.3 + 0.7 * (1 - parseFloat(entropyRate));
    
    document.getElementById('quantum-viz').appendChild(link);
}

// é‡å­åˆ†æåŠŸèƒ½
document.getElementById('quantum-analyze').addEventListener('click', function() {
    const entropy = parseFloat(document.getElementById('q-entropy').textContent);
    const layers = parseInt(document.getElementById('q-layers').textContent);
    
    let message = "Quantum Analysis Results:\n";
    message += `- Observer Layers: ${layers}\n`;
    message += `- Entropy Rate: ${entropy.toFixed(1)}\n`;
    
    if(entropy > 0.7) {
        message += "\nWarning: High financial entropy detected!\n";
        message += "Consider stabilizing your budget flow.";
    } else if(layers >= 5) {
        message += "\nNotice: Complex financial consciousness detected.\n";
        message += "Your budget has multiple interacting dimensions.";
    } else {
        message += "\nStatus: Budget consciousness is stable.\n";
        message += "Quantum fluctuations are within normal range.";
    }
    
    alert(message);
});

// æ”¶å…¥åŠŸèƒ½
function addIncome() {
    const date = document.getElementById("incomeDate").value;
    const source = document.getElementById("incomeSource").value;
    const amount = parseFloat(document.getElementById("incomeAmount").value);

    if (!date || !source || isNaN(amount) || amount <= 0) {
        alert("Please fill in all income fields correctly.");
        return;
    }

    let found = false;
    incomeRecords.forEach(record => {
        if (record.source === source && record.date === date) {
            record.amount += amount;
            found = true;
        }
    });

    if (!found) {
        incomeRecords.push({ id: Date.now(), source, amount, date });
    }

    renderIncomeTable();
    updateBudget();
    saveDataToLocalStorage();
    renderQuantumViz();

    document.getElementById("incomeDate").value = "";
    document.getElementById("incomeSource").value = "";
    document.getElementById("incomeAmount").value = "";
}

function renderIncomeTable() {
    const tbody = document.getElementById("incomeTable").querySelector("tbody");
    tbody.innerHTML = "";
    incomeRecords.forEach(record => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${record.source}</td>
            <td>${record.amount.toFixed(2)}</td>
            <td>${record.date}</td>
            <td><button onclick="deleteIncome(${record.id})" class="delete-btn">Delete</button></td>
        `;
        tbody.appendChild(row);
    });
}

function deleteIncome(id) {
    incomeRecords = incomeRecords.filter(record => record.id !== id);
    renderIncomeTable();
    updateBudget();
    saveDataToLocalStorage();
    renderQuantumViz();
}

// æ”¯å‡ºåŠŸèƒ½
function addExpense() {
    const date = document.getElementById("expenseDate").value;
    const name = document.getElementById("itemName").value;
    const price = parseFloat(document.getElementById("itemPrice").value);
    const quantity = parseInt(document.getElementById("itemQuantity").value);

    if (!date || !name || isNaN(price) || isNaN(quantity) || price <= 0 || quantity <= 0) {
        alert("Please fill in all expense fields correctly.");
        return;
    }

    let found = false;
    expenseRecords.forEach(record => {
        if (record.name === name && record.price === price && record.date === date) {
            record.quantity += quantity;
            record.total += price * quantity;
            found = true;
        }
    });

    if (!found) {
        expenseRecords.push({ id: Date.now(), name, price, quantity, total: price * quantity, date });
    }

    renderExpenseTable();
    updateBudget();
    saveDataToLocalStorage();
    renderQuantumViz();

    document.getElementById("expenseDate").value = "";
    document.getElementById("itemName").value = "";
    document.getElementById("itemPrice").value = "";
    document.getElementById("itemQuantity").value = 1;
}

function renderExpenseTable() {
    const tbody = document.getElementById("expenseTable").querySelector("tbody");
    tbody.innerHTML = "";
    expenseRecords.forEach(record => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${record.name}</td>
            <td>${record.price.toFixed(2)}</td>
            <td>${record.quantity}</td>
            <td>${record.total.toFixed(2)}</td>
            <td>${record.date}</td>
            <td><button onclick="deleteExpense(${record.id})" class="delete-btn">Delete</button></td>
        `;
        tbody.appendChild(row);
    });
}

function deleteExpense(id) {
    expenseRecords = expenseRecords.filter(record => record.id !== id);
    renderExpenseTable();
    updateBudget();
    saveDataToLocalStorage();
    renderQuantumViz();
}

// æ›´æ–°é¢„ç®—
function updateBudget() {
    const totalIncome = incomeRecords.reduce((sum, record) => sum + record.amount, 0);
    const totalExpenses = expenseRecords.reduce((sum, record) => sum + record.total, 0);
    const remainingBudget = totalIncome - totalExpenses;

    document.getElementById("totalAmount").textContent = totalExpenses.toFixed(2);
    document.getElementById("remainingAmount").textContent = remainingBudget.toFixed(2);
    
    // æ ¹æ®é¢„ç®—çŠ¶æ€æ”¹å˜é¢œè‰²
    if(remainingBudget < 0) {
        document.getElementById("remainingAmount").style.color = "#ff6b6b";
    } else if(remainingBudget < totalIncome * 0.3) {
        document.getElementById("remainingAmount").style.color = "#ffcc00";
    } else {
        document.getElementById("remainingAmount").style.color = "#00f0ff";
    }
}

// æ¸…ç©ºæ•°æ®
function clearData() {
    if (confirm("Are you sure you want to clear all data?")) {
        incomeRecords = [];
        expenseRecords = [];
        renderIncomeTable();
        renderExpenseTable();
        updateBudget();
        localStorage.removeItem("budgetData");
        renderQuantumViz();
    }
}

// æ—¥æœŸè¿‡æ»¤
function filterRecords() {
    const startDate = new Date(document.getElementById("startDate").value);
    const endDate = new Date(document.getElementById("endDate").value);

    const filteredIncome = incomeRecords.filter(record => {
        const recordDate = new Date(record.date);
        return recordDate >= startDate && recordDate <= endDate;
    });

    const filteredExpense = expenseRecords.filter(record => {
        const recordDate = new Date(record.date);
        return recordDate >= startDate && recordDate <= endDate;
    });

    renderFilteredTables(filteredIncome, filteredExpense);
}

function renderFilteredTables(filteredIncome, filteredExpense) {
    const incomeTbody = document.getElementById("incomeTable").querySelector("tbody");
    incomeTbody.innerHTML = "";
    filteredIncome.forEach(record => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${record.source}</td>
            <td>${record.amount.toFixed(2)}</td>
            <td>${record.date}</td>
            <td><button onclick="deleteIncome(${record.id})" class="delete-btn">Delete</button></td>
        `;
        incomeTbody.appendChild(row);
    });

    const expenseTbody = document.getElementById("expenseTable").querySelector("tbody");
    expenseTbody.innerHTML = "";
    filteredExpense.forEach(record => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${record.name}</td>
            <td>${record.price.toFixed(2)}</td>
            <td>${record.quantity}</td>
            <td>${record.total.toFixed(2)}</td>
            <td>${record.date}</td>
            <td><button onclick="deleteExpense(${record.id})" class="delete-btn">Delete</button></td>
        `;
        expenseTbody.appendChild(row);
    });
}

// é‡å­é¢„æµ‹ç®—æ³•
function calculateLinearRegression(data) {
    const n = data.length;
    let sumX = 0, sumY = 0, sumXY = 0, sumX2 = 0;

    for (let i = 0; i < n; i++) {
        sumX += i;
        sumY += data[i];
        sumXY += i * data[i];
        sumX2 += i * i;
    }

    const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
    const intercept = (sumY - slope * sumX) / n;

    return { slope, intercept };
}

function recursiveLayerPrediction(data, decay = 0.85) {
    let weightedSum = 0;
    let totalWeight = 0;

    for (let i = 0; i < data.length; i++) {
        const weight = Math.pow(decay, data.length - i - 1);
        weightedSum += data[i] * weight;
        totalWeight += weight;
    }

    return totalWeight === 0 ? 0 : weightedSum / totalWeight;
}

function simulateQuantumNoise(mean = 0, stdDev = 0.01) {
    return mean + stdDev * (Math.random() * 2 - 1);
}

function enhancedHybridPrediction(data, seasonalityFactor = 1.0) {
    if (data.length < 2) return { prediction: 0, lowerBound: 0, upperBound: 0 };
    
    const { slope, intercept } = calculateLinearRegression(data);
    const linear = slope * data.length + intercept;
    const recursive = recursiveLayerPrediction(data);
    const noise = simulateQuantumNoise();
    
    // è®¡ç®—æ ‡å‡†å·®ä½œä¸ºç½®ä¿¡åŒºé—´
    const mean = 0.5 * linear + 0.4 * recursive + 0.1 * noise;
    let variance = 0;
    for (const value of data) {
        variance += Math.pow(value - mean, 2);
    }
    const stdDev = Math.sqrt(variance / data.length);
    
    // åº”ç”¨å­£èŠ‚æ€§å› å­
    const prediction = (0.5 * linear + 0.4 * recursive + 0.1 * noise) * seasonalityFactor;
    
    return {
        prediction: Math.max(0, prediction),
        lowerBound: Math.max(0, prediction - stdDev),
        upperBound: prediction + stdDev
    };
}

function predictFutureIncomeOrExpenses() {
    // ç®€å•å­£èŠ‚æ€§å› ç´ 
    const currentMonth = new Date().getMonth();
    const seasonalityFactor = 1 + 0.1 * Math.sin((currentMonth / 12) * 2 * Math.PI);
    
    const incomeData = incomeRecords.map(record => record.amount);
    const expenseData = expenseRecords.map(record => record.total);
    
    return {
        incomePrediction: enhancedHybridPrediction(incomeData, seasonalityFactor),
        expensePrediction: enhancedHybridPrediction(expenseData, seasonalityFactor)
    };
}

function updatePredictionUI() {
    const { incomePrediction, expensePrediction } = predictFutureIncomeOrExpenses();
    
    // æ›´æ–°æ”¶å…¥é¢„æµ‹æ˜¾ç¤º
    if (incomePrediction.prediction > 0) {
        document.getElementById('predictedIncome').innerHTML = `
            Predicted income for next month: 
            RM ${incomePrediction.prediction.toFixed(2)} 
            <small>(likely range: ${incomePrediction.lowerBound.toFixed(2)} - ${incomePrediction.upperBound.toFixed(2)})</small>
        `;
    } else {
        document.getElementById('predictedIncome').textContent =
            "Predicted income for next month: RM 0.00";
    }
    
    // æ›´æ–°æ”¯å‡ºé¢„æµ‹æ˜¾ç¤º
    if (expensePrediction.prediction > 0) {
        document.getElementById('predictedExpense').innerHTML = `
            Predicted expense for next month: 
            RM ${expensePrediction.prediction.toFixed(2)} 
            <small>(likely range: ${expensePrediction.lowerBound.toFixed(2)} - ${expensePrediction.upperBound.toFixed(2)})</small>
        `;
    } else {
        document.getElementById('predictedExpense').textContent =
            "Predicted expense for next month: RM 0.00";
    }
    
    // æ›´è¯¦ç»†çš„å»ºè®®
    let suggestion = "";
    if (incomePrediction.prediction === 0 && expensePrediction.prediction === 0) {
        suggestion = "Not enough data to make predictions. Please add more records.";
    } else {
        const remainingBudget = incomePrediction.prediction - expensePrediction.prediction;
        const safeThreshold = expensePrediction.prediction * 0.3;
        
        if (remainingBudget < -safeThreshold) {
            const deficit = -remainingBudget;
            suggestion = `Warning: Predicted deficit of RM ${deficit.toFixed(2)}. 
                          Consider reducing expenses by ${(deficit/expensePrediction.prediction*100).toFixed(1)}%.`;
        } else if (remainingBudget < safeThreshold) {
            suggestion = "Budget is tight. Consider limiting discretionary spending.";
        } else if (remainingBudget < expensePrediction.prediction * 0.5) {
            suggestion = "Budget looks balanced. You're doing well!";
        } else {
            suggestion = "Budget looks healthy. You might consider saving or investing the surplus.";
        }
    }
    
    document.getElementById('budgetSuggestion').innerHTML = suggestion;
}

// å›¾è¡¨åˆå§‹åŒ–
function initCharts() {
    // æ”¯å‡ºåˆ†ç±»ç»Ÿè®¡
    const expenseCtx = document.getElementById('expenseChart').getContext('2d');
    const expenseChart = new Chart(expenseCtx, {
        type: 'doughnut',
        data: {
            labels: ['é£Ÿç‰©', 'äº¤é€š', 'å¨±ä¹', 'å­¦ä¹ ', 'å…¶ä»–'],
            datasets: [{
                data: [35, 20, 15, 20, 10], // ç¤ºä¾‹æ•°æ®ï¼Œå®é™…åº”ä»æ•°æ®è®¡ç®—
                backgroundColor: [
                    '#9d00ff',
                    '#00f0ff',
                    '#6e00ff',
                    '#ff00aa',
                    '#00ffaa'
                ],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        color: '#fff',
                        font: {
                            family: 'Exo 2'
                        }
                    }
                }
            }
        }
    });

    // æ”¶å…¥æ¥æºç»Ÿè®¡
    const incomeCtx = document.getElementById('incomeChart').getContext('2d');
    const incomeChart = new Chart(incomeCtx, {
        type: 'pie',
        data: {
            labels: ['å·¥èµ„', 'æŠ•èµ„', 'å…¼èŒ', 'å…¶ä»–'],
            datasets: [{
                data: [60, 20, 15, 5], // ç¤ºä¾‹æ•°æ®ï¼Œå®é™…åº”ä»æ•°æ®è®¡ç®—
                backgroundColor: [
                    '#9d00ff',
                    '#00f0ff',
                    '#6e00ff',
                    '#ff00aa'
                ],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        color: '#fff',
                        font: {
                            family: 'Exo 2'
                        }
                    }
                }
            }
        }
    });

    // åˆå§‹åŒ–ä»ªè¡¨ç›˜
    initGauges();
}

function initGauges() {
    // é¢„ç®—å¹³è¡¡åº¦ä»ªè¡¨ç›˜
    const balanceGauge = new Gauge(document.getElementById('balanceGauge')).setOptions({
        angle: 0.15,
        lineWidth: 0.1,
        radiusScale: 1,
        pointer: {
            length: 0.6,
            strokeWidth: 0.035,
            color: '#00f0ff'
        },
        limitMax: false,
        limitMin: false,
        colorStart: '#9d00ff',
        colorStop: '#00f0ff',
        strokeColor: '#1a1a3a',
        generateGradient: true,
        highDpiSupport: true,
        staticZones: [
            {strokeStyle: "#FF0000", min: 0, max: 30},
            {strokeStyle: "#FF9900", min: 30, max: 70},
            {strokeStyle: "#00FF00", min: 70, max: 100}
        ],
        staticLabels: {
            font: "10px sans-serif",
            labels: [0, 30, 70, 100],
            color: "#fff",
            fractionDigits: 0
        }
    });
    balanceGauge.maxValue = 100;
    balanceGauge.setMinValue(0);
    balanceGauge.animationSpeed = 32;
    balanceGauge.set(75); // ç¤ºä¾‹å€¼ï¼Œå®é™…åº”ä»æ•°æ®è®¡ç®—

    // å‚¨è“„ç‡ä»ªè¡¨ç›˜
    const savingGauge = new Gauge(document.getElementById('savingGauge')).setOptions({
        angle: 0.15,
        lineWidth: 0.1,
        radiusScale: 1,
        pointer: {
            length: 0.6,
            strokeWidth: 0.035,
            color: '#9d00ff'
        },
        limitMax: false,
        limitMin: false,
        colorStart: '#00f0ff',
        colorStop: '#9d00ff',
        strokeColor: '#1a1a3a',
        generateGradient: true,
        highDpiSupport: true,
        staticZones: [
            {strokeStyle: "#FF0000", min: 0, max: 10},
            {strokeStyle: "#FF9900", min: 10, max: 20},
            {strokeStyle: "#00FF00", min: 20, max: 50}
        ],
        staticLabels: {
            font: "10px sans-serif",
            labels: [0, 10, 20, 50],
            color: "#fff",
            fractionDigits: 0
        }
    });
    savingGauge.maxValue = 50;
    savingGauge.setMinValue(0);
    savingGauge.animationSpeed = 32;
    savingGauge.set(25); // ç¤ºä¾‹å€¼ï¼Œå®é™…åº”ä»æ•°æ®è®¡ç®—
}

// äº‹ä»¶ç›‘å¬
document.getElementById("addIncomeBtn").addEventListener("click", addIncome);
document.getElementById("addItemBtn").addEventListener("click", addExpense);
document.getElementById("clearDataBtn").addEventListener("click", clearData);
document.getElementById("filterBtn").addEventListener("click", filterRecords);
document.getElementById("predictBtn").addEventListener("click", updatePredictionUI);

// åé¦ˆè¡¨å•å¤„ç†
document.getElementById('feedbackForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const message = document.getElementById('feedbackMessage').value.trim();
    
    if(message) {
        // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…å‘é€åé¦ˆçš„é€»è¾‘
        alert('æ„Ÿè°¢æ‚¨çš„é‡å­åé¦ˆï¼å®ƒå·²è¢«å åŠ åˆ°æˆ‘ä»¬çš„æ„è¯†åœºä¸­ã€‚');
        document.getElementById('feedbackMessage').value = '';
        
        // åˆ›å»ºé‡å­åé¦ˆåŠ¨ç”»
        const quantumEffect = document.createElement('div');
        quantumEffect.style.position = 'fixed';
        quantumEffect.style.top = '50%';
        quantumEffect.style.left = '50%';
        quantumEffect.style.width = '10px';
        quantumEffect.style.height = '10px';
        quantumEffect.style.background = '#00f0ff';
        quantumEffect.style.borderRadius = '50%';
        quantumEffect.style.transform = 'translate(-50%, -50%)';
        quantumEffect.style.boxShadow = '0 0 15px #9d00ff';
        quantumEffect.style.zIndex = '9999';
        document.body.appendChild(quantumEffect);
        
        // åŠ¨ç”»æ•ˆæœ
        let size = 10;
        let opacity = 1;
        const grow = setInterval(() => {
            size += 5;
            opacity -= 0.05;
            quantumEffect.style.width = `${size}px`;
            quantumEffect.style.height = `${size}px`;
            quantumEffect.style.opacity = opacity;
            
            if(opacity <= 0) {
                clearInterval(grow);
                quantumEffect.remove();
            }
        }, 30);
    } else {
        alert('è¯·å…ˆè¾“å…¥æ‚¨çš„åé¦ˆå†…å®¹ï¼');
    }
});

// é¡µé¢è¿‡æ¸¡æ•ˆæœ - ä»…ç”¨äºå¤–éƒ¨é¡µé¢è·³è½¬
document.querySelectorAll('a[href$=".HTML"]:not(.internal-link)').forEach(link => {
    link.addEventListener('click', function(e) {
        if(this.getAttribute('href') !== '#') {
            e.preventDefault();
            const transition = document.createElement('div');
            transition.className = 'page-transition';
            document.body.appendChild(transition);
            
            setTimeout(() => {
                transition.style.opacity = '1';
            }, 10);
            
            setTimeout(() => {
                window.location.href = this.href;
            }, 500);
        }
    });
});

// åˆå§‹åŒ–
window.addEventListener('load', function() {
    document.body.classList.add('loaded');
    manageSakura();
    loadDataFromLocalStorage();
    
    // å¡ç‰‡å…¥åœºåŠ¨ç”»
    const cards = document.querySelectorAll('.welcome-card');
    cards.forEach((card, index) => {
        card.style.transition = `all 0.5s ease ${index * 0.1}s`;
        setTimeout(() => {
            card.classList.add('visible');
        }, 100);
    });
    
    // æ·»åŠ æŒ‰é’®ç‚¹å‡»åŠ¨ç”»
    document.querySelectorAll('button, .btn, a').forEach(btn => {
        btn.addEventListener('click', function() {
            this.style.transform = 'scale(0.95)';
            setTimeout(() => {
                this.style.transform = '';
            }, 200);
        });
    });
    
    // åŠ è½½å›¾è¡¨åº“
    const chartScript = document.createElement('script');
    chartScript.src = 'https://cdn.jsdelivr.net/npm/chart.js';
    chartScript.onload = initCharts;
    document.head.appendChild(chartScript);

    const gaugeScript = document.createElement('script');
    gaugeScript.src = 'https://bernii.github.io/gauge.js/dist/gauge.min.js';
    gaugeScript.onload = initGauges;
    document.head.appendChild(gaugeScript);
});

window.addEventListener('resize', function() {
    if (window.innerHeight < 500) {
        const activeInput = document.activeElement;
        if (activeInput.tagName === 'INPUT') {
            activeInput.scrollIntoView({ block: 'center' });
        }
    }
    renderQuantumViz();
});
</script>
</body>
</html>