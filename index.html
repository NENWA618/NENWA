<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NENWA - Recipes & Budget Tracker</title>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.js"></script>
<link rel="icon" href="NENWA.png">
<style>
/* é¡µé¢å…¨å±€æ ·å¼ */
body {
    font-family: 'Arial', sans-serif;
    margin: 0;
    padding: 0;
    background: linear-gradient(180deg, #fff7f2 0%, #ffe5d8 100%); /* æš–è‰²èƒŒæ™¯æ¸å˜ */
    color: #333;
}

/* ===== æ¨±èŠ±ç‰¹æ•ˆ ===== */  
.sakura-container {  
  position: fixed;  
  top: 0;  
  left: 0;  
  width: 100%;  
  height: 100%;  
  pointer-events: none;  
  z-index: 9999;  
}  

.sakura {  
    position: absolute;  
    background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="%23ff9a9e" d="M12 2C13.1 2 14 2.9 14 4S13.1 6 12 6 10 5.1 10 4 10.9 2 12 2m3.5 6.5c.3-.8 1.2-1.2 2-.9.8.3 1.2 1.2.9 2-.3.8-1.2 1.2-2 .9-.8-.3-1.2-1.2-.9-2zM7 12c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2m11.5-1.5c.8-.3 1.7.1 2 .9.3.8-.1 1.7-.9 2-.8.3-1.7-.1-2-.9-.3-.8.1-1.7.9-2z"/></svg>');  
    width: 24px;  
    height: 24px;  
    animation: fall linear infinite;
    animation-duration: var(--duration, 10s); /* ä½¿ç”¨ CSS å˜é‡ */
    animation-delay: var(--delay, 0s); /* ä½¿ç”¨ CSS å˜é‡ */
}

@keyframes fall {
  to { 
    transform: translateY(100vh) rotate(360deg);
    animation-timing-function: cubic-bezier(0.4, 0.2, 0.8, 0.6); /* å…ˆå¿«åæ…¢ */
  }  
}

/* é¼ æ ‡äº’åŠ¨ï¼šèŠ±ç“£å‘ä¸¤ä¾§é£˜æ•£ */  
body:hover .sakura {  
  animation-name: fall-mouse;  
}  
@keyframes fall-mouse {  
  50% { transform: translateX(calc(var(--mouse-x) * 100px)) rotate(180deg); }  
  100% { transform: translateY(100vh) translateX(0) rotate(360deg); }  
}  

.hidden-content {
    display: none;
}

.logo img {
    width: 50px;
    height: auto;
}

#toggleNav {
    position: fixed;
    top: 15px; /* è°ƒæ•´æŒ‰é’®è·ç¦»é¡¶éƒ¨çš„è·ç¦» */
    left: 15px; /* è°ƒæ•´æŒ‰é’®è·ç¦»å·¦ä¾§çš„è·ç¦» */
    background: none;
    border: none;
    font-size: 24px; /* æ”¾å¤§æŒ‰é’® */
    cursor: pointer;
    z-index: 1100; /* ç¡®ä¿åœ¨æœ€å‰é¢ */
    color: white; /* è®©æŒ‰é’®é¢œè‰²ä¸å¯¼èˆªæ ä¸€è‡´ */
}

#toggleNav:hover {
    color: #ffdede; /* æ‚¬åœæ—¶å˜æµ… */
}

/* æœç´¢æŒ‰é’®æ ·å¼ */
.nav-links li {
    display: flex;
    align-items: center;
}

.search-btn {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1.1em;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.search-btn:hover {
    transform: scale(1.1); /* æ‚¬åœæ—¶æ”¾å¤§ */
    box-shadow: 0 4px 8px rgba(255, 255, 255, 0.3); /* æ·»åŠ å…‰æ™• */
}

.search-btn:active {
    transform: scale(0.95); /* ç‚¹å‡»æ—¶ç¼©å° */
    box-shadow: 0 2px 4px rgba(255, 255, 255, 0.2); /* å‡å¼±å…‰æ™• */
}

/* æœç´¢æ æ ·å¼ */
.search-bar {
    position: fixed;
    top: 70px;
    right: 20px;
    width: 250px;
    padding: 10px;
    background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
    border-radius: 8px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    display: none;
    flex-direction: column;
    align-items: center;
    z-index: 1000;
}

.search-bar input {
    width: 100%;
    padding: 8px;
    border: none;
    border-radius: 5px;
    margin-bottom: 5px;
}

/* ğŸ”¹ å›åˆ°é¡¶éƒ¨æŒ‰é’® */
.back-to-top {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #ff9a9e;
    color: white;
    padding: 12px 16px;
    border: none;
    border-radius: 5px;
    font-size: 1.1em;
    cursor: pointer;
    display: none; /* é»˜è®¤éšè— */
    transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
}

.back-to-top:hover {
    background: #ff6b6b;
}

.back-to-top.show {
    display: block; /* æ˜¾ç¤ºæŒ‰é’® */
    opacity: 1;
    transform: scale(1.1);
}

/* Sticky Header Design */
#poetry-header {
    position: sticky;
    top: 0;
    z-index: 1000;
    height: 180px;
    background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
    color: #fff;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    border-bottom: 3px solid rgba(255, 255, 255, 0.3);
    padding: 15px 20px;
}

#poetry-header h1 {
    font-size: 2.5em;
    font-family: 'Georgia', serif;
    color: #fff;
    margin: 5px 0;
    letter-spacing: 2px;
}

#poetry-header p {
    font-size: 1.3em;
    font-style: italic;
    line-height: 1.6;
    color: #f8f8f8;
    margin: 10px 0 0;
    letter-spacing: 1px;
    text-align: center;
}

/* ğŸ”¹ å¯¼èˆªæ æ ·å¼ */
.navbar {
    position: fixed;
    top: 0;
    width: 100%;
    background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
    color: white;
    padding: 10px 20px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    justify-content: space-between;
    align-items: center;
    z-index: 1000;
    opacity: 0;
    pointer-events: none;
    transform: translateY(-20px); /* åˆå§‹ä¸Šç§»éšè— */
    transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
    flex-wrap: nowrap; /* ç¦æ­¢æ¢è¡Œï¼Œè¶…å‡ºéƒ¨åˆ†å¯æ»šåŠ¨ */
}

.nav-bar::-webkit-scrollbar {
    display: none; /* éšè—æ»šåŠ¨æ¡ */
}

.navbar.show {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0);
}

.nav-container {
    display: flex;
    justify-content: space-between;
    width: 100%;
    max-width: 1100px;
    margin: 0 auto;
}

.nav-links {
    list-style: none;
    display: flex;
    gap: 20px;
    flex-wrap: nowrap; /* ç¦æ­¢æ¢è¡Œï¼Œè¶…å‡ºéƒ¨åˆ†å¯æ»šåŠ¨ */
}

.nav-links li {
    display: inline;
}

.nav-links a {
    color: white;
    text-decoration: none;
    font-size: 1.1em;
    transition: color 0.3s ease;
}

.nav-links a:hover {
    color: #ffdede;
}

/* æŒ‰é’®æ ·å¼ */
button, .btn, input[type="text"], textarea, input[type="number"] {
    width: 80%; /* é»˜è®¤å ç”¨å®½åº¦ */
    max-width: 400px; /* å¤§å±ä¸‹é€‚å½“é™åˆ¶å®½åº¦ */
    margin: 0 auto; /* å±…ä¸­æ˜¾ç¤º */
    box-sizing: border-box; /* åŒ…å«paddingå’Œborder */
}

button, .btn {
    background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
    color: #fff;
    border: none;
    padding: 12px 24px;
    font-size: 1.1em;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: transform 0.2s, box-shadow 0.2s, background 0.3s;
    cursor: pointer;
    width: auto;
}

button:hover, .btn:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
    background: linear-gradient(135deg, #ff6b6b 0%, #fad0c4 100%);
}

button:active, .btn:active {
    transform: scale(0.98);
    box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
}

button, .delete-btn {
    transition: transform 0.3s ease, background-color 0.3s ease;
}

/* è¾“å…¥æ¡†æ ·å¼ */
input[type="text"], textarea, input[type="number"] {
    width: 100%;
    max-width: 400px;
    padding: 12px;
    border: 2px solid #fad0c4;
    border-radius: 8px;
    font-size: 1em;
    margin-bottom: 20px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: border-color 0.3s, box-shadow 0.3s;
}

input[type="text"]:focus, textarea:focus, input[type="number"]:focus {
    outline: none;
    border-color: #ff9a9e;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
}

input[type="text"]:hover, textarea:hover, input[type="number"]:hover {
    border-color: #ff9a9e;
    box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
}

/* é“¾æ¥æ ·å¼ */
a {
    color: #ff6b6b;
    text-decoration: none;
    transition: color 0.2s;
}

a:hover {
    color: #ff4a4a;
}

/* è¡¨æ ¼æ ·å¼ */
table {
    table-layout: fixed;
    width: 90%;
    max-width: 1200px;
    border-collapse: collapse;
    border-spacing: 6px;
    margin-top: 20px;
    font-size: 0.9em;
    overflow-x: auto;
    white-space: nowrap;
    margin: 0 auto;
}

table th, table td {
    border: 1px solid #fad0c4;
    padding: 12px;
    text-align: left;
    font-size: 1.05em;
}

table th {
    background: #ff9a9e;
    color: #fff;
}

table tr:nth-child(even) {
    background: #ffe5d8;
}

table tr:hover {
    background: #ffd2c3;
}

table td button.delete-btn {
    background: #ff6b6b;
    border: none;
    padding: 6px 12px;
    border-radius: 5px;
    color: #fff;
    cursor: pointer;
    font-size: 0.9em;
    transition: background 0.3s;
}

table td button.delete-btn:hover {
    background: #ff4a4a;
}

@media (min-width: 1024px) {
    #poetry-header {
        width: 100%; /* Sticky éƒ¨åˆ†å®½åº¦è´´æ»¡å±å¹• */
    }

    #poetry-header h1 {
        font-size: 3em;
    }

    button, .btn {
        font-size: 1.2em;
    }

    table {
        font-size: 1.2em;
    }
}

/* æ‰‹æœºç«¯å¯¼èˆªæ ç´§æ€¥è¡¥ä¸ */
@media (max-width: 768px) {
  .nav-links {
    flex-direction: column; /* æ–°å¢ */
    gap: 0; /* è¦†ç›–åŸæœ‰gap */
    max-height: 70vh; /* æ–°å¢ */
    overflow-y: auto; /* æ”¹ä¸ºå‚ç›´æ»šåŠ¨ */
    padding: 0; /* è¦†ç›–åŸæœ‰padding */
  }
  .nav-links li {
    padding: 12px 20px; /* æ–°å¢ */
    border-bottom: 1px solid rgba(255,255,255,0.2); /* æ–°å¢ */
  }
  .nav-links a {
    font-size: 1.2em !important; /* æ–°å¢ */
  }
  .nav-links::-webkit-scrollbar {
    height: 3px;                /* è¶…è–„æ»šåŠ¨æ¡ */
    background: rgba(255,154,158,0.3); /* çŒ›ç”·ç²‰åŠé€æ˜ */
  }
  .nav-links::-webkit-scrollbar-thumb {
    background: #ff9a9e;         /* æ»šåŠ¨æ¡æœ¬ä½“æ›´ç²‰ */
  }
  #incomeTable, #expenseTable {
    position: relative;
  }
  #incomeTable::after, #expenseTable::after {
    content: "æ»‘åŠ¨æŸ¥çœ‹ â†’";
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: #ff9a9e;
    font-size: 0.8em;
    animation: pulse 2s infinite;
  }
  @keyframes pulse {
    0% { opacity: 0.5; }
    50% { opacity: 1; }
    100% { opacity: 0.5; }
  }
}

@media (max-width: 480px) {
    #poetry-header h1 {
        font-size: 1.6em;
    }
    #poetry-header p {
        font-size: 0.9em;
        line-height: 1.4;
        padding: 0 8px;
    }
    table {
        font-size: 0.8em; /* é¿å…å­—ä½“è¿‡å° */
        overflow-x: auto;
    }
    table th, table td {
        padding: 6px;
    }
    body {
        padding: 8px;
    }
}

#budget > div {
    margin-bottom: 20px; /* é—´è· */
}

#totalAmount {
    transition: background-color 0.3s ease;
}

#remainingAmount {
    transition: background-color 0.3s ease;
}
</style>
</head>
<body>

<!-- Header Section -->
<header id="poetry-header">
<div class="overlay">
<button id="toggleNav">â˜°</button>
        <h1>ç§‹ä¹¦å¶è½</h1>
    </div>
</header>

<!-- ğŸ”¹ å¯¼èˆªæ  -->
<nav class="navbar">
    <div class="nav-container">
        <a href="index.html" class="logo"><img src="NENWA.png" alt="Logo"></a>
        <ul class="nav-links">
            <li><a href="#recipes">Recipes</a></li>
            <li><a href="#budget">Budget Tracker</a></li>
            <li><a href="#" id="searchToggle" class="search-btn">ğŸ”</a></li>
        </ul>
    </div>
</nav>

<!-- æœç´¢æ  -->
<div id="searchBar" class="search-bar">
    <input type="text" id="searchInput" placeholder="Type here and search...">
    <button id="searchBtn">Search</button>
</div>

<!-- ğŸ”¹ å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<button id="backToTop" class="back-to-top">â¬† Back to Top</button>

<!-- éšè—å†…å®¹ -->
<div class="hidden-content">
    <h3><a href="zichuandepianzhang.HTML">ç´«å·çš„ç¯‡ç« </a></h3>
</div>

<!-- Recipes Section -->
<div id="recipes" class="section">
    <span class="anchor" id="recipes"></span>
    <h2>Recipes</h2>
    <h3><a href="oyakodon.HTML">oyakodon äº²å­ä¸¼ï¼ˆãŠã‚„ã“ã©ã‚“ï¼‰</a></h3>
    <h3><a href="tendon.HTML">tendon å¤©ä¸¼ï¼ˆã¦ã‚“ã©ã‚“ï¼‰</a></h3>
    <h3><a href="gyuudon.HTML">gyuudon ç‰›ä¸¼ï¼ˆãã‚…ã†ã©ã‚“ï¼‰</a></h3>
    <h3><a href="katsudon.HTML">katsudon ã‹ã¤ä¸¼ï¼ˆã‹ã¤ã©ã‚“ï¼‰</a></h3>
    <h3><a href="yakisoba.HTML">yakisoba ç„¼ããã°ï¼ˆã‚„ããã°ï¼‰</a></h3>
    <h3><a href="yakiudon.HTML">yakiudon ç„¼ã†ã©ã‚“ï¼ˆã‚„ãã†ã©ã‚“ï¼‰</a></h3>
    <h3><a href="kakeudon.HTML">kakeudon ã‹ã‘ã†ã©ã‚“</a></h3>
    <h3><a href="tacorice.HTML">tacorice ã‚¿ã‚³ãƒ©ã‚¤ã‚¹</a></h3>
    <h3><a href="makunouchibentou.HTML">makunouchibentou å¹•ã®å†…å¼å½“ï¼ˆã¾ãã®ã†ã¡ã¹ã‚“ã¨ã†ï¼‰</a></h3>
    <h3><a href="noriben.HTML">noriben ã®ã‚Šå¼ï¼ˆã®ã‚Šã¹ã‚“ï¼‰</a></h3>
   </div>

<!-- Budget Section -->
<div id="budget" class="section">
    <span class="anchor" id="budget"></span>
    <h2>Budget Tracker</h2>

<!-- Income Section -->
<div>
    <label for="incomeDate">Date:</label>
<input type="text" 
       id="incomeDate" 
       onfocus="this.type='date'" 
       onblur="if(!this.value) this.type='text'"
       placeholder="...">
    <br><br>
    <label for="incomeSource">Income Source:</label>
    <input type="text" id="incomeSource" placeholder="Enter income source" required>
    <br>
    <label for="incomeAmount">Amount (RM):</label>
    <input type="number" id="incomeAmount" placeholder="Enter income amount" min="0" step="0.01" required>
    <br>
    <button id="addIncomeBtn" aria-label="Add Income Record">Add Income</button>
</div>
 <br>
    <h3>Income Records:</h3>
    <table id="incomeTable" border="1">
        <thead>
            <tr>
                <th>Source</th>
                <th>Amount (RM)</th>
		<th>Date</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <!-- Income items will be dynamically added here -->
        </tbody>
    </table>
    <br><br>

<!-- Expenses Section -->
<div>
    <label for="expenseDate">Date:</label>
<input type="text" 
       id="expenseDate" 
       onfocus="this.type='date'" 
       onblur="if(!this.value) this.type='text'"
       placeholder="...">
    <br><br>
    <label for="itemName">Item Name (Expense):</label>
    <input type="text" id="itemName" placeholder="Enter item name">
    <br>
    <label for="itemPrice">Price (RM):</label>
    <input type="number" id="itemPrice" placeholder="Enter item price" min="0" step="0.01">
    <br>
    <label for="itemQuantity">Quantity:</label>
    <input type="number" id="itemQuantity" placeholder="Enter item quantity" value="1" min="1">
    <br>
    <button id="addItemBtn" aria-label="Add Expense">Add Expense</button>
</div>
    <br>
    <h3>Expenses:</h3>
    <table id="expenseTable" border="1">
        <thead>
            <tr>
                <th>Item Name</th>
                <th>Price (RM)</th>
                <th>Quantity</th>
                <th>Total (RM)</th>
		<th>Date</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <!-- Expense items will be dynamically added here -->
        </tbody>
    </table>
<br><br>
<div>
<p id="totalPrice">Total Price: RM <span id="totalAmount">0</span></p>
</div>
<div>
<p id="remainingBudget">Remaining Budget: RM <span id="remainingAmount">0</span></p>
</div>

    <!-- Clear All Data Button -->
    <button id="clearDataBtn">Clear All Data</button>
</div>
<br><br>

<!-- Date Range Filter -->
<div>
    <label for="startDate">Start Date:</label>
    <input type="date" id="startDate">
    <br><br>
    <label for="endDate">End Date:</label>
    <input type="date" id="endDate">
    <br><br>
    <button id="filterBtn" aria-label="Filter Records">Filter</button>
</div>
<br>

<div>
    <h3>Future Prediction:</h3>
    <p id="predictedIncome">Predicted income for next month: RM 0.00</p>
    <p id="predictedExpense">Predicted expense for next month: RM 0.00</p>
    <p id="budgetSuggestion"></p>
<button id="predictBtn" aria-label="Predict Future">Predict Future</button>
</div>
<br>

<footer>
    <p>Â© 2024 NENWA. All rights reserved.</p>
    <p>
        <a href="Privacy_Policy.HTML">Privacy Policy</a> |
        <a href="Terms_of_Service.HTML">Terms of Service</a> |
        <a href="Contact_Us.HTML">Contact Us</a>
    </p>
</footer>

<script>
// æ¨±èŠ±ç”Ÿæˆå™¨
function createSakura() {  
    const sakura = document.createElement('div');  
    sakura.className = 'sakura';  
    sakura.style.left = Math.random() * 100 + 'vw';  
    
    // è®¾ç½®éšæœºåŠ¨ç”»å‚æ•°
    const duration = 5 + Math.random() * 10; // 5-15ç§’
    const delay = Math.random() * 5; // 0-5ç§’å»¶è¿Ÿ
    
    sakura.style.setProperty('--duration', duration + 's');
    sakura.style.setProperty('--delay', delay + 's');
    
    sakura.style.opacity = 0.5 + Math.random() * 0.5;  
    document.querySelector('.sakura-container').appendChild(sakura);  
    
    // æ¨±èŠ±æ¶ˆå¤±åå‡å°‘è®¡æ•°
    setTimeout(() => {
        sakura.remove();
        sakuraCount--;
    }, duration * 1000);
}  

// åˆå§‹åŒ–æ¨±èŠ±å®¹å™¨
const container = document.createElement('div');  
container.className = 'sakura-container';  
document.body.appendChild(container);  

let sakuraCount = 0;
const maxSakura = 20;

function manageSakura() {
    if (sakuraCount < maxSakura) {
        createSakura();
        sakuraCount++;
    }
    setTimeout(manageSakura, 500 + Math.random() * 800); // éšæœºé—´éš”0.5-1.3ç§’
}

// å¯åŠ¨æ¨±èŠ±ç”Ÿæˆ
manageSakura();

// é¼ æ ‡ä½ç½®è¿½è¸ªï¼ˆç”¨äºäº’åŠ¨ç‰¹æ•ˆï¼‰
let lastX = 0;
document.addEventListener('mousemove', (e) => {
    const speed = Math.abs(e.clientX - lastX);
    const panicLevel = Math.min(speed / 10, 5);
    document.documentElement.style.setProperty('--mouse-x', 
        (e.clientX / window.innerWidth - 0.5) * panicLevel);
    lastX = e.clientX;
});

// åˆ‡æ¢æœç´¢æ çš„æ˜¾ç¤º/éšè—
document.getElementById("searchToggle").addEventListener("click", function() {
    var searchBar = document.getElementById("searchBar");
    searchBar.style.display = searchBar.style.display === "flex" ? "none" : "flex";
});

// æœç´¢é€»è¾‘å°è£…ä¸ºä¸€ä¸ªå‡½æ•°
function performSearch() {
    var query = document.getElementById("searchInput").value.toLowerCase().trim();

    if (!query) {
        alert("è¯·è¾“å…¥æœç´¢å†…å®¹ï¼");
        return;
    }

    var recipes = document.querySelectorAll("#recipes h3 a"); // å¯è§çš„èœè°±
    var hiddenSections = document.querySelectorAll(".hidden-content"); // éšè—çš„èœè°±åŒºå—
    let found = false;

    function normalizeText(text) {
        return text.replace(/\s+/g, "").toLowerCase(); // å»æ‰ç©ºæ ¼å¹¶è½¬ä¸ºå°å†™
    }

    // å¤„ç†å¯è§çš„èœè°±
    recipes.forEach(function(recipe) {
        if (!recipe.textContent) return;

        let text = normalizeText(recipe.textContent);
        if (text.includes(normalizeText(query))) {
            recipe.style.display = "block"; // æ˜¾ç¤ºåŒ¹é…çš„èœè°±
            found = true;
        } else {
            recipe.style.display = "none";  // éšè—æœªåŒ¹é…çš„èœè°±
        }
    });

    // å¤„ç†éšè—çš„å†…å®¹
    hiddenSections.forEach(function(section) {
        let hasMatch = false;
        let items = section.querySelectorAll("*"); // é€‰æ‹©è¯¥éšè—åŒºåŸŸä¸‹çš„æ‰€æœ‰å…ƒç´ 

        items.forEach(function(item) {
            if (!item.textContent) return;

            let text = normalizeText(item.textContent);
            if (text.includes(normalizeText(query))) {
                item.style.display = "block"; // ä»…æ˜¾ç¤ºåŒ¹é…çš„å­é¡¹
                hasMatch = true;
                found = true;
            } else {
                item.style.display = "none";  // å…¶ä»–å†…å®¹éšè—
            }
        });

        // **å¦‚æœè¯¥ `.hidden-content` é‡Œå®Œå…¨æ²¡æœ‰åŒ¹é…é¡¹ï¼Œåˆ™ä»ç„¶éšè—**
        section.style.display = hasMatch ? "block" : "none";
    });

    if (!found) {
        alert("æœªæ‰¾åˆ°åŒ¹é…çš„èœè°±ï¼Œè¯·å°è¯•ä½¿ç”¨æ—¥è¯­ã€ä¸­æ–‡æˆ–è‹±è¯­æœç´¢ï¼");
    }
}

// ç›‘å¬ç‚¹å‡»æœç´¢æŒ‰é’®
document.getElementById("searchBtn").addEventListener("click", performSearch);

// ç›‘å¬è¾“å…¥æ¡†çš„ Enter é”®
document.getElementById("searchInput").addEventListener("keydown", function(event) {
    if (event.key === "Enter") {
        performSearch(); // è§¦å‘æœç´¢
    }
});

// å¯¼èˆªæ å±•å¼€/æŠ˜å 
document.getElementById("toggleNav").addEventListener("click", function(e) {
    e.stopPropagation();
    const navbar = document.querySelector(".navbar");
    const isOpen = navbar.classList.toggle("show");
    
    document.body.style.overflow = isOpen ? "hidden" : "";
    
    if (isOpen) {
        document.addEventListener("click", function closeMenu(event) {
            if (!navbar.contains(event.target)) {
                navbar.classList.remove("show");
                document.body.style.overflow = "";
                document.removeEventListener("click", closeMenu);
            }
        });
    }
});

// ğŸ”¹ ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œæ˜¾ç¤º/éšè—æŒ‰é’®
window.addEventListener("scroll", function () {
    let backToTopBtn = document.getElementById("backToTop");
    if (window.scrollY > 300) {
        backToTopBtn.classList.add("show");
    } else {
        backToTopBtn.classList.remove("show");
    }
});

document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault(); // é˜»æ­¢é»˜è®¤çš„è·³è½¬è¡Œä¸º
        const targetId = this.getAttribute('href'); // è·å–ç›®æ ‡éƒ¨åˆ†çš„ID
        const target = document.querySelector(targetId); // æŸ¥æ‰¾ç›®æ ‡éƒ¨åˆ†

        if (target) {
            const headerHeight = document.querySelector('header').offsetHeight; // è·å–å¤´éƒ¨é«˜åº¦
            const position = target.offsetTop - headerHeight; // è®¡ç®—ç›®æ ‡ä½ç½®

            window.scrollTo({
                top: position, // æ»šåŠ¨åˆ°ç›®æ ‡ä½ç½®
                behavior: 'smooth', // å¯ç”¨å¹³æ»‘æ»šåŠ¨æ•ˆæœ
            });
        }
    });
});

// ğŸ”¹ ç‚¹å‡»æŒ‰é’®ï¼Œå›åˆ°é¡µé¢é¡¶éƒ¨
document.getElementById("backToTop").addEventListener("click", function () {
    window.scrollTo({ top: 0, behavior: "smooth" });
});

// å…¨å±€å˜é‡
let incomeRecords = [];
let expenseRecords = [];

// æœ¬åœ°å­˜å‚¨åŠ è½½ä¸ä¿å­˜
function saveDataToLocalStorage() {
    const data = { incomeRecords, expenseRecords };
    localStorage.setItem("budgetData", JSON.stringify(data));
}

function loadDataFromLocalStorage() {
    const data = JSON.parse(localStorage.getItem("budgetData"));
    if (data) {
        incomeRecords = data.incomeRecords || [];
        expenseRecords = data.expenseRecords || [];
        renderIncomeTable();
        renderExpenseTable();
        updateBudget();
    }
}

// æ·»åŠ æ”¶å…¥
function addIncome() {
    const date = document.getElementById("incomeDate").value;
    const source = document.getElementById("incomeSource").value;
    const amount = parseFloat(document.getElementById("incomeAmount").value);

    if (!date || !source || isNaN(amount) || amount <= 0) {
        alert("Please fill in all income fields correctly.");
        return;
    }

    let found = false;
    incomeRecords.forEach(record => {
        if (record.source === source && record.date === date) {
            record.amount += amount; // å åŠ é‡‘é¢
            found = true;
        }
    });

    if (!found) {
        incomeRecords.push({ id: Date.now(), source, amount, date });
    }

    renderIncomeTable();
    updateBudget();
    saveDataToLocalStorage();

    document.getElementById("incomeDate").value = "";
    document.getElementById("incomeSource").value = "";
    document.getElementById("incomeAmount").value = "";
}

// æ¸²æŸ“æ”¶å…¥è¡¨æ ¼
function renderIncomeTable() {
    const tbody = document.getElementById("incomeTable").querySelector("tbody");
    tbody.innerHTML = "";
    incomeRecords.forEach(record => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${record.source}</td>
            <td>${record.amount.toFixed(2)}</td>
            <td>${record.date}</td>
            <td><button onclick="deleteIncome(${record.id})">Delete</button></td>
        `;
        tbody.appendChild(row);
    });
}

// åˆ é™¤æ”¶å…¥
function deleteIncome(id) {
    incomeRecords = incomeRecords.filter(record => record.id !== id);
    renderIncomeTable();
    updateBudget();
    saveDataToLocalStorage();
}

// æ·»åŠ æ”¯å‡º
function addExpense() {
    const date = document.getElementById("expenseDate").value;
    const name = document.getElementById("itemName").value;
    const price = parseFloat(document.getElementById("itemPrice").value);
    const quantity = parseInt(document.getElementById("itemQuantity").value);

    if (!date || !name || isNaN(price) || isNaN(quantity) || price <= 0 || quantity <= 0) {
        alert("Please fill in all expense fields correctly.");
        return;
    }

    let found = false;
    expenseRecords.forEach(record => {
        if (record.name === name && record.price === price && record.date === date) {
            record.quantity += quantity; // å åŠ æ•°é‡
            record.total += price * quantity; // å åŠ æ€»ä»·
            found = true;
        }
    });

    if (!found) {
        expenseRecords.push({ id: Date.now(), name, price, quantity, total: price * quantity, date });
    }

    renderExpenseTable();
    updateBudget();
    saveDataToLocalStorage();

    document.getElementById("expenseDate").value = "";
    document.getElementById("itemName").value = "";
    document.getElementById("itemPrice").value = "";
    document.getElementById("itemQuantity").value = 1;
}

// æ¸²æŸ“æ”¯å‡ºè¡¨æ ¼
function renderExpenseTable() {
    const tbody = document.getElementById("expenseTable").querySelector("tbody");
    tbody.innerHTML = "";
    expenseRecords.forEach(record => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${record.name}</td>
            <td>${record.price.toFixed(2)}</td>
            <td>${record.quantity}</td>
            <td>${record.total.toFixed(2)}</td>
            <td>${record.date}</td>
            <td><button onclick="deleteExpense(${record.id})">Delete</button></td>
        `;
        tbody.appendChild(row);
    });
}

// åˆ é™¤æ”¯å‡º
function deleteExpense(id) {
    expenseRecords = expenseRecords.filter(record => record.id !== id);
    renderExpenseTable();
    updateBudget();
    saveDataToLocalStorage();
}

// æ›´æ–°é¢„ç®—
function updateBudget() {
    const totalIncome = incomeRecords.reduce((sum, record) => sum + record.amount, 0);
    const totalExpenses = expenseRecords.reduce((sum, record) => sum + record.total, 0);
    const remainingBudget = totalIncome - totalExpenses;

    document.getElementById("totalAmount").textContent = totalExpenses.toFixed(2);
    document.getElementById("remainingAmount").textContent = remainingBudget.toFixed(2);
}

// æ¸…ç©ºæ•°æ®
function clearData() {
    if (confirm("Are you sure you want to clear all data?")) {
        incomeRecords = [];
        expenseRecords = [];
        renderIncomeTable();
        renderExpenseTable();
        updateBudget();
        localStorage.removeItem("budgetData");
    }
}

// æ—¥æœŸè¿‡æ»¤
function filterRecords() {
    const startDate = new Date(document.getElementById("startDate").value);
    const endDate = new Date(document.getElementById("endDate").value);

    const filteredIncome = incomeRecords.filter(record => {
        const recordDate = new Date(record.date);
        return recordDate >= startDate && recordDate <= endDate;
    });

    const filteredExpense = expenseRecords.filter(record => {
        const recordDate = new Date(record.date);
        return recordDate >= startDate && recordDate <= endDate;
    });

    renderFilteredTables(filteredIncome, filteredExpense);
}

// æ¸²æŸ“è¿‡æ»¤åçš„è¡¨æ ¼
function renderFilteredTables(filteredIncome, filteredExpense) {
    const incomeTbody = document.getElementById("incomeTable").querySelector("tbody");
    incomeTbody.innerHTML = "";
    filteredIncome.forEach(record => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${record.source}</td>
            <td>${record.amount.toFixed(2)}</td>
            <td>${record.date}</td>
            <td><button onclick="deleteIncome(${record.id})">Delete</button></td>
        `;
        incomeTbody.appendChild(row);
    });

    const expenseTbody = document.getElementById("expenseTable").querySelector("tbody");
    expenseTbody.innerHTML = "";
    filteredExpense.forEach(record => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${record.name}</td>
            <td>${record.price.toFixed(2)}</td>
            <td>${record.quantity}</td>
            <td>${record.total.toFixed(2)}</td>
            <td>${record.date}</td>
            <td><button onclick="deleteExpense(${record.id})">Delete</button></td>
        `;
        expenseTbody.appendChild(row);
    });
}

document.getElementById("addIncomeBtn").addEventListener("click", addIncome);
document.getElementById("addItemBtn").addEventListener("click", addExpense);
document.getElementById("clearDataBtn").addEventListener("click", clearData);
document.getElementById("filterBtn").addEventListener("click", filterRecords);
// ç»‘å®šé¢„æµ‹æŒ‰é’®äº‹ä»¶
document.getElementById("predictBtn").addEventListener("click", updatePredictionUI);


// åŠ è½½æœ¬åœ°å­˜å‚¨æ•°æ®
window.onload = loadDataFromLocalStorage;

function calculateMovingAverage(data, period = 3) {
    if (data.length < period) return null; // Return null if not enough data
    let sum = 0;
    for (let i = 0; i < period; i++) {
        sum += data[data.length - 1 - i]; // Take the last N months' data
    }
    return sum / period;
}

function calculateLinearRegression(data) {
    const n = data.length;
    let sumX = 0, sumY = 0, sumXY = 0, sumX2 = 0;

    // Calculate the necessary sums
    for (let i = 0; i < n; i++) {
        sumX += i;          // Time series: 0, 1, 2, ...
        sumY += data[i];    // Income or expense data
        sumXY += i * data[i];
        sumX2 += i * i;
    }

    // Calculate the regression coefficients
    const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
    const intercept = (sumY - slope * sumX) / n;

    return { slope, intercept };
}

function predictLinearRegression(data, futureIndex) {
    const { slope, intercept } = calculateLinearRegression(data);
    return slope * futureIndex + intercept; // Predict the future value
}

function predictFutureIncomeOrExpenses() {
    const lastMonthsIncome = incomeRecords.map(record => record.amount);
    const lastMonthsExpenses = expenseRecords.map(record => record.total);

    console.log("Income Records:", lastMonthsIncome);  // æ£€æŸ¥æ”¶å…¥æ•°æ®
    console.log("Expense Records:", lastMonthsExpenses);  // æ£€æŸ¥æ”¯å‡ºæ•°æ®

    let incomePrediction = 0;
    let expensePrediction = 0;

    if (lastMonthsIncome.length >= 3) {
        incomePrediction = calculateMovingAverage(lastMonthsIncome, 3);
    } else if (lastMonthsIncome.length > 0) {
        incomePrediction = predictLinearRegression(lastMonthsIncome, lastMonthsIncome.length);
    }

    if (lastMonthsExpenses.length >= 3) {
        expensePrediction = calculateMovingAverage(lastMonthsExpenses, 3);
    } else if (lastMonthsExpenses.length > 0) {
        expensePrediction = predictLinearRegression(lastMonthsExpenses, lastMonthsExpenses.length);
    }

    console.log("Predicted Income:", incomePrediction);
    console.log("Predicted Expense:", expensePrediction);

    return { incomePrediction, expensePrediction };
}

function updatePredictionUI() {
    const { incomePrediction, expensePrediction } = predictFutureIncomeOrExpenses();

    if (incomePrediction > 0 || expensePrediction > 0) {
        document.getElementById('predictedIncome').textContent =
            `Predicted income for next month: RM ${incomePrediction.toFixed(2)}`;
        document.getElementById('predictedExpense').textContent =
            `Predicted expense for next month: RM ${expensePrediction.toFixed(2)}`;

        const remainingBudget = incomePrediction - expensePrediction;
        const suggestion = remainingBudget < 0
            ? "Warning: Budget may not be enough, consider reducing expenses!"
            : "Suggestion: The budget looks healthy, keep it up!";
        document.getElementById('budgetSuggestion').textContent = suggestion;
    } else {
        document.getElementById('predictedIncome').textContent =
            "Predicted income for next month: RM 0.00";
        document.getElementById('predictedExpense').textContent =
            "Predicted expense for next month: RM 0.00";
        document.getElementById('budgetSuggestion').textContent =
            "Not enough data to make predictions. Please add more records.";
    }
}

window.addEventListener('resize', function() {
    if (window.innerHeight < 500) {
        const activeInput = document.activeElement;
        if (activeInput.tagName === 'INPUT') {
            activeInput.scrollIntoView({ block: 'center' });
        }
    }
});
</script>

</body>
</html>
